@model Domain.Entities.NTGLevelThreeDiagnosis

@{    
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
   var (module, parent) = (Context.Request.Query["module"].ToString(), Context.Request.Query["parent"].ToString());
}

<div class="row ps-2 pe-2 ps-sm-4 pe-sm-4 offset-1 CardOffset">
   <div class="col-md-10 col-lg-10 p-0 ps-sm-4 ClCard">

        <div class="card">
            <div class="card-body ps-4 pe-4 ps-sm-5 pe-sm-5">

                @if (TempData[Utilities.Constants.SessionConstants.Message] != null)
                {
                    <div class="row g-3 me-0 ms-0 mt-1">
                        <div class="alert alert-danger" role="alert">
                            @TempData[Utilities.Constants.SessionConstants.Message]
                        </div>
                    </div>
                }

                <!--HEADER-->
                <div class="pagetitle">
                    <h4 class="card-title fs-2 fw-bold mb-0">NTG Level Three Diagnosis</h4>
                    <p class="mb-1" style="font-size:14px">Fields marked by <span class="text-danger">*</span> are mandatory</p>
                    <hr class="mt-0">
                </div>

                <!--FORM START-->
                <form class="row g-1" method="post" asp-action="Edit" asp-controller="NTGLevelThreeDiagnosis">
                    <input asp-for="Oid" type="hidden" />
                     <input type="hidden" value="@ViewBag.NtgId" asp-for="NTGLevelTwoId" />
                     <input type="hidden" name="module" value="@module" />
                     <input type="hidden" name="parent" value="@parent" />

                    <!--NTG Level One-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <select for="NTGLevelOneID" id="NTGLevelOneID" class="form-select" aria-label="State" onchange="GetNTGLevelTwobyNTGLevelOne(event)" asp-items="@ViewBag.NTGLevelOneDiagnoses" disabled>
                                <option value="">Select</option>
                            </select>
                            <label class="required" for="NTGLevelOneID">NTG Level One</label>
                        </div>
                    </div>

                    <!--NTG Level Two-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <select asp-for="NTGLevelTwoId" id="NTGLevelTwoID" name="NTGLevelTwoID" data-val="true" data-val-required="Required." asp-items="@ViewBag.NTGLevelTwo" class="form-select" aria-label="State" disabled>
                                <option value="">Select</option>
                            </select>
                            <label class="required" asp-for="NTGLevelTwoId">NTG Level Two</label>
                            <span asp-validation-for="NTGLevelTwoId" class="text-danger"></span>
                        </div>
                    </div>

                    <!--Diagnosis-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <input asp-for="Description" type="text" id="name" class="form-control" data-val="true" data-val-required="Required." data-val-length-max="90" data-val-length-min="2" data-val-length="Diagnosis should be atleast 2 digits.">
                            <label class="required" asp-for="Description">NTG Level Three</label>
                            <span asp-validation-for="Description" class="text-danger"></span>
                        </div>
                    </div>

                    <!--ICDID-->
                     <div class="col-md-12 mt-3">
                        <div class="col-md-6">
                           <label>ICD Code :</label>
                        </div>

                        <div class="mt-1">
                            <select asp-for="ICDId" class="form-select select2 pt-3 pb-3" data-show-subtext="true" data-live-search="true" data-val="true" asp-items="@ViewBag.ICD" aria-label="State">
                                <option value="" class="pt-2">Select</option>
                            </select>
                             <span asp-validation-for="ICDId" class="text-danger"></span>
                        </div>
                     </div>

                    <!--ClinicalFeatures-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <textarea asp-for="ClinicalFeatures" type="text" id="name" class="form-control" rows="4" style="height:25%"></textarea>
                            <label asp-for="ClinicalFeatures">Clinical Features</label>
                            <span asp-validation-for="ClinicalFeatures" class="text-danger"></span>
                        </div>
                    </div>

                    <!--RecommendedInvestigations-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <textarea asp-for="RecommendedInvestigations" type="text" id="name" class="form-control" rows="4" style="height:25%"></textarea>
                            <label asp-for="RecommendedInvestigations">Recommended Investigations</label>
                            <span asp-validation-for="RecommendedInvestigations" class="text-danger"></span>
                        </div>
                    </div>

                    <!--Investigation Notes-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <textarea asp-for="InvestigationNotes" type="text" id="name" class="form-control" rows="4" style="height:25%"></textarea>
                            <label asp-for="InvestigationNotes">Investigation Notes</label>
                            <span asp-validation-for="InvestigationNotes" class="text-danger"></span>
                        </div>
                    </div>

                    <!--Treatment Notes-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <textarea asp-for="TreatmentNotes" type="text" id="name" class="form-control" rows="4" style="height:25%"></textarea>
                            <label asp-for="TreatmentNotes">Treatment Notes</label>
                            <span asp-validation-for="TreatmentNotes" class="text-danger"></span>
                        </div>
                    </div>

                    <!--Pharmacy-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <textarea asp-for="Pharmacy" type="text" id="name" class="form-control" rows="4" style="height:25%"></textarea>
                            <label asp-for="Pharmacy">Pharmacy</label>
                            <span asp-validation-for="Pharmacy" class="text-danger"></span>
                        </div>
                    </div>

                    <!--Complications-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <textarea asp-for="Complications" type="text" id="name" class="form-control" rows="4" style="height:25%"></textarea>
                            <label asp-for="Complications">Complications</label>
                            <span asp-validation-for="Complications" class="text-danger"></span>
                        </div>
                    </div>

                    <!--Prevention-->
                    <div class="col-md-12">
                        <div class="form-floating mt-2">
                            <textarea asp-for="Prevention" type="text" id="name" class="form-control" rows="4" style="height:25%"></textarea>
                            <label asp-for="Prevention">Prevention</label>
                            <span asp-validation-for="Prevention" class="text-danger"></span>
                        </div>
                    </div>

                    <!--ACTIONS-->
                     <div class="col-12 mt-0 mt-3 text-center">
                        <button class="btn btn-primary btn-lg mx-2" id="btnSave" type="submit">
                           <i class="bi bi-check2-circle"></i> Submit
                        </button>
                        <a href="/NTGLevelThreeDiagnosis/Index?module=@module&parent=@parent&oid=@ViewBag.NtgId" class="btn btn-secondary btn-lg"><i class="bi bi-x-circle"></i> Close</a>
                     </div>
                </form>

            </div>
        </div>
    </div>
</div>

@section Scripts {
    <!--JS LINK-->
   @*  <script src="~/js/site.js"></script>
    <script src="~/js/cdns/jquery.min.js"></script> *@

    <script>

        function GetNTGLevelTwobyNTGLevelOne(event) {
            var oid = event.target.value;
            $.ajax({
                type: 'GET',
                url: '/NTGLevelThreeDiagnosis/LoadNTGLevelThree',
                dataType: 'json',
                data: { id: oid },
                success: function (nTGLevelTwo) {
                    $("#NTGLevelTwoID").empty();
                    $("#NTGLevelTwoID").append(`<option value="0">Select NTG Level Two</option>`);
                    var data = "";
                    nTGLevelTwo.forEach(function (item) {
                        data = `<option value="${item.oid}">${item.description}</option>`
                        $("#NTGLevelTwoID").append(data);
                    })
                }
            })
        }

    </script>
}